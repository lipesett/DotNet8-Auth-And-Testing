# Secure API with Auth & Testing - .NET 8 Portfolio

![.NET](https://img.shields.io/badge/.NET-8-blueviolet) ![C#](https://img.shields.io/badge/C%23-11-blue) ![xUnit](https://img.shields.io/badge/Tests-xUnit-green) ![JWT](https://img.shields.io/badge/Auth-JWT-red) ![Clean Architecture](https://img.shields.io/badge/Architecture-Clean-orange)

This repository contains a complete RESTful API featuring a robust token-based authentication and authorization system using JWT. A key highlight of this project is the comprehensive suite of automated integration tests that validate the security and functionality of the API, ensuring its reliability.

Built with .NET 8, this project demonstrates a professional approach to creating secure and verifiable backend services.

## üöÄ Concepts and Technologies Applied

This project showcases a wide range of essential backend development skills:

* **Security & Authentication:**
    * **ASP.NET Core Identity:** For secure user and password management, including hashing and storing user data.
    * **JWT (JSON Web Token) Authentication:** Implementation of a stateless, token-based authentication flow. Includes endpoints for user registration and login, and token generation via a dedicated `TokenService`.
    * **Authorization Middleware:** Configuration of the `JwtBearer` middleware to validate tokens on incoming requests.
    * **Protected Endpoints:** Use of the `[Authorize]` attribute to secure specific API resources, making them accessible only to authenticated users.

* **Automated Testing (xUnit):**
    * **Integration Testing:** A dedicated test project (`SecureApi.Tests`) that validates the API's behavior from end to end.
    * **`WebApplicationFactory`:** Utilization of an in-memory test server to make real HTTP requests to the API without needing to host it.
    * **In-Memory SQLite Database:** Configuration of a custom `WebApplicationFactory` to ensure each test run uses a clean, isolated, in-memory database, guaranteeing test atomicity and reliability.
    * **Security Testing:** Tests that specifically prove the security rules are working, verifying that endpoints return `401 Unauthorized` for requests without a token and `200 OK` for requests with a valid token.

* **Architecture & Best Practices:**
    * **Clean Architecture & SOLID:** A layered architecture (Controller, Service, Repository) that adheres to SOLID principles for maintainable and scalable code.
    * **Repository Pattern & Dependency Injection:** Abstraction of data access and extensive use of DI for a decoupled and testable codebase.
    * **Swagger/OpenAPI:** Configuration of Swagger to support JWT authentication, allowing for easy manual testing of protected endpoints via the "Authorize" button.

## üìã API Endpoints

The API exposes the following endpoints:

| Verb     | Route                 | Description                        | Security             |
| :------- | :-------------------- | :--------------------------------- | :------------------- |
| `POST`   | `/api/Auth/register`  | Registers a new user.              | **Public** |
| `POST`   | `/api/Auth/login`     | Authenticates a user and returns a JWT. | **Public** |
| `GET`    | `/api/Products`       | Lists all products.                | **Protected (Requires Token)** |

## ‚öôÔ∏è How to Run the Project

### Prerequisites
* [.NET 8 SDK](https://dotnet.microsoft.com/download/dotnet/8.0)
* Git

### Steps

1.  **Clone the repository:**
    ```bash
    git clone [https://github.com/SEU-USUARIO/.Net8-Auth-And-Testing.git](https://github.com/SEU-USUARIO/.Net8-Auth-And-Testing.git)
    ```
    (Remember to replace `SEU-USUARIO` with your GitHub username)

2.  **Navigate to the project folder:**
    ```bash
    cd .Net8-Auth-And-Testing/SecureApi
    ```

3.  **Prepare the Database (First time only):**
    This command creates the `secureapi.db` database file with the Identity tables.
    ```bash
    dotnet ef database update
    ```
    > **Note:** If you are using Visual Studio's Package Manager Console, use the command `Update-Database` instead. If the `dotnet ef` command is not found in your terminal, you may need to install it globally with `dotnet tool install --global dotnet-ef`.

4.  **Run the application:**
    ```bash
    dotnet run
    ```
    The API will be running locally. You can access the Swagger UI at the URL shown in the terminal (usually `https://localhost:7XXX/swagger`).

## üß™ How to Run the Tests

You can run the automated tests in two ways:

1.  **Via .NET CLI:**
    Navigate to the solution's root folder (`.Net8-Auth-And-Testing`) and run:
    ```bash
    dotnet test
    ```

2.  **Via Visual Studio:**
    Open the **Test Explorer** window (**Test > Test Explorer**). The tests will be discovered automatically, and you can run them by clicking the "Run All Tests" button.

---
---

# API Segura com Autentica√ß√£o e Testes - Portf√≥lio .NET 8

![.NET](https://img.shields.io/badge/.NET-8-blueviolet) ![C#](https://img.shields.io/badge/C%23-11-blue) ![xUnit](https://img.shields.io/badge/Testes-xUnit-green) ![JWT](https://img.shields.io/badge/Auth-JWT-red) ![Arquitetura Limpa](https://img.shields.io/badge/Arquitetura-Clean-orange)

Este reposit√≥rio cont√©m uma API RESTful completa com um sistema robusto de autentica√ß√£o e autoriza√ß√£o baseado em tokens JWT. Um destaque do projeto √© a su√≠te abrangente de testes de integra√ß√£o automatizados que validam a seguran√ßa e a funcionalidade da API, garantindo sua confiabilidade.

Constru√≠do com .NET 8, este projeto demonstra uma abordagem profissional para a cria√ß√£o de servi√ßos de backend seguros e verific√°veis.

## üöÄ Conceitos e Tecnologias Aplicadas

Este projeto demonstra uma vasta gama de habilidades essenciais para o desenvolvimento backend:

* **Seguran√ßa e Autentica√ß√£o:**
    * **ASP.NET Core Identity:** Para gerenciamento seguro de usu√°rios e senhas, incluindo hashing e armazenamento de dados de usu√°rio.
    * **Autentica√ß√£o JWT (JSON Web Token):** Implementa√ß√£o de um fluxo de autentica√ß√£o stateless baseado em token. Inclui endpoints para registro e login de usu√°rios, e gera√ß√£o de token via um `TokenService` dedicado.
    * **Middleware de Autoriza√ß√£o:** Configura√ß√£o do middleware `JwtBearer` para validar tokens em requisi√ß√µes recebidas.
    * **Endpoints Protegidos:** Uso do atributo `[Authorize]` para proteger recursos espec√≠ficos da API, tornando-os acess√≠veis apenas a usu√°rios autenticados.

* **Testes Automatizados (xUnit):**
    * **Testes de Integra√ß√£o:** Um projeto de teste (`SecureApi.Tests`) dedicado a validar o comportamento da API de ponta a ponta.
    * **`WebApplicationFactory`:** Utiliza√ß√£o de um servidor de teste em mem√≥ria para fazer requisi√ß√µes HTTP reais √† API sem a necessidade de hosped√°-la.
    * **Banco de Dados SQLite em Mem√≥ria:** Configura√ß√£o de uma `WebApplicationFactory` customizada para garantir que cada execu√ß√£o de teste utilize um banco de dados limpo, isolado e em mem√≥ria, garantindo a atomicidade e confiabilidade dos testes.
    * **Testes de Seguran√ßa:** Testes que provam especificamente que as regras de seguran√ßa est√£o funcionando, verificando que endpoints retornam `401 Unauthorized` para requisi√ß√µes sem token e `200 OK` para requisi√ß√µes com um token v√°lido.

* **Arquitetura e Boas Pr√°ticas:**
    * **Arquitetura Limpa & SOLID:** Uma arquitetura em camadas (Controller, Service, Repository) que adere aos princ√≠pios SOLID para um c√≥digo manuten√≠vel e escal√°vel.
    * **Padr√£o de Reposit√≥rio & Inje√ß√£o de Depend√™ncia:** Abstra√ß√£o do acesso a dados e uso extensivo de DI para um c√≥digo desacoplado e test√°vel.
    * **Swagger/OpenAPI:** Configura√ß√£o do Swagger para suportar autentica√ß√£o JWT, permitindo testes manuais f√°ceis de endpoints protegidos atrav√©s do bot√£o "Authorize".

## üìã Endpoints da API

A API exp√µe os seguintes endpoints:

| Verbo    | Rota                  | Descri√ß√£o                                 | Seguran√ßa                     |
| :------- | :-------------------- | :---------------------------------------- | :---------------------------- |
| `POST`   | `/api/Auth/register`  | Registra um novo usu√°rio.                 | **P√∫blico** |
| `POST`   | `/api/Auth/login`     | Autentica um usu√°rio e retorna um JWT.    | **P√∫blico** |
| `GET`    | `/api/Products`       | Lista todos os produtos.                  | **Protegido (Requer Token)** |

## ‚öôÔ∏è Como Executar o Projeto

### Pr√©-requisitos
* [.NET 8 SDK](https://dotnet.microsoft.com/pt-br/download/dotnet/8.0)
* Git

### Passos

1.  **Clone o reposit√≥rio:**
    ```bash
    git clone [https://github.com/SEU-USUARIO/.Net8-Auth-And-Testing.git](https://github.com/SEU-USUARIO/.Net8-Auth-And-Testing.git)
    ```
    (Lembre-se de substituir `SEU-USUARIO` pelo seu nome de usu√°rio do GitHub)

2.  **Navegue at√© a pasta do projeto:**
    ```bash
    cd .Net8-Auth-And-Testing/SecureApi
    ```

3.  **Prepare o Banco de Dados (Apenas na primeira vez):**
    Este comando cria o arquivo de banco de dados `secureapi.db` com as tabelas do Identity. O comando a ser usado depende do seu terminal.

    * **Se voc√™ estiver usando um terminal padr√£o (Git Bash, PowerShell, CMD):**
        Primeiro, pode ser necess√°rio instalar a ferramenta global do EF Core (voc√™ s√≥ precisa fazer isso uma vez por m√°quina):
        ```bash
        dotnet tool install --global dotnet-ef
        ```
        Em seguida, execute o comando de atualiza√ß√£o:
        ```bash
        dotnet ef database update
        ```

    * **Se voc√™ estiver usando o Package Manager Console (PMC) do Visual Studio:**
        Simplesmente execute o comando:
        ```powershell
        Update-Database
        ```

4.  **Execute a Aplica√ß√£o:**
    Este √© o comando que voc√™ usar√° no dia a dia para iniciar o servidor da API.
    ```bash
    dotnet run
    ```
    A API estar√° rodando localmente. Voc√™ pode acessar a documenta√ß√£o do Swagger na URL indicada no terminal (geralmente `https://localhost:7XXX/swagger`).

## üß™ Como Rodar os Testes

Voc√™ pode executar os testes automatizados de duas formas:

1.  **Via .NET CLI:**
    Navegue at√© a pasta raiz da solu√ß√£o (`.Net8-Auth-And-Testing`) e execute:
    ```bash
    dotnet test
    ```

2.  **Via Visual Studio:**
    Abra a janela do **Test Explorer** (**Menu Test > Test Explorer**). Os testes ser√£o descobertos automaticamente, e voc√™ pode execut√°-los clicando no bot√£o "Run All Tests".
